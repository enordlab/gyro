{"version":3,"sources":["Serial.js","react-flight-indicators/img/fi_box.svg","react-flight-indicators/img/heading_yaw.svg","react-flight-indicators/img/heading_mechanics.svg","react-flight-indicators/img/fi_circle.svg","react-flight-indicators/img/horizon_back.svg","react-flight-indicators/img/vertical_mechanics.svg","react-flight-indicators/img/fi_needle.svg","react-flight-indicators/img/turn_coordinator.svg","react-flight-indicators/img/fi_tc_airplane.svg","react-flight-indicators/img/speed_mechanics.svg","react-flight-indicators/img/altitude_pressure.svg","react-flight-indicators/img/altitude_ticks.svg","react-flight-indicators/img/fi_needle_small.svg","react-flight-indicators/img/horizon_ball.svg","react-flight-indicators/img/horizon_circle.svg","react-flight-indicators/img/horizon_mechanics.svg","react-flight-indicators/index.js","App.js","index.js"],"names":["LineBreakTransformer","_classCallCheck","this","container","_createClass","key","value","chunk","controller","lines","split","pop","forEach","line","enqueue","Serial","_this","setApp","app","connect","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","navigator","serial","requestPort","comm","sent","open","baudRate","bufferSize","reader","readable","pipeThrough","TextDecoderStream","TransformStream","getReader","writer","writable","getWriter","setTimeout","receive","t0","document","getElementById","innerHTML","message","replace","stop","_callee2","result","str","_context2","read","update","running","send","_ref3","_callee3","_context3","console","log","length","substr","write","enc","encode","buffer","_x","apply","arguments","start","_callee4","_context4","_callee5","_context5","undefined","TextEncoder","dec","TextDecoder","constants","box","width","height","position","top","left","Instrument","_ref","children","showBox","size","_jsxs","className","style","display","overflow","_jsx","src","fi_box","alt","HeadingIndicator","params","_params$heading","_objectSpread","transform","concat","heading","heading_yaw","heading_mechanics","fi_circle","AttitudeIndicator","_params$pitch","_params$roll","pitch","roll","horizon_back","horizon_ball","horizon_circle","horizon_mechanics","Scene","props","materials","useLoader","MTLLoader","obj","OBJLoader","loader","preload","setMaterials","object","rotate","ry","Math","PI","rx","rz","scale","App","_React$Component","_inherits","_super","_createSuper","call","map","s","Number","setState","state","test_update","_assertThisInitialized","_this2","type","onClick","event","id","Canvas","Suspense","fallback","React","Component","rootElement","ReactDOM","render"],"mappings":"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","file":"static/js/main.436e3cbe.chunk.js","sourcesContent":["// Readable Object\n// https://wicg.github.io/serial/#readable-attribute\n\nclass LineBreakTransformer {\n  constructor() {\n    this.container = '';\n  }\n\n  transform(chunk, controller) {\n    this.container += chunk;\n    const lines = this.container.split('\\r\\n');\n    this.container = lines.pop();\n    lines.forEach(line => controller.enqueue(line));\n  }\n\n  flush(controller) {\n    controller.enqueue(this.container);\n  }\n}\n\n\nclass Serial {\n\n  constructor() {\n    this.comm = undefined;\n    this.reader= undefined;\n    this.writer= undefined;\n    this.enc = new TextEncoder();\n    this.dec = new TextDecoder();\n    this.running = false;\n\n    this.app = undefined;\n  }\n\n  setApp = (app) => {\n    this.app = app;\n  }\n\n  // the user wants to connect to an emulated COM port\n  connect = async () =>\n  {\n    if ('serial' in navigator) {\n      try {\n        this.comm = await navigator.serial.requestPort({});\n        await this.comm.open({ baudRate: 115200, bufferSize: 64 });\n        // this.reader = this.comm.readable.getReader();\n\n        this.reader = this.comm.readable\n        .pipeThrough(new TextDecoderStream())\n        .pipeThrough(new TransformStream(new LineBreakTransformer()))\n        .getReader();\n\n        this.writer = this.comm.writable.getWriter();\n        setTimeout(this.receive, 100);\n        // document.getElementById(\"command\").disabled = false;\n        // document.getElementById(\"command\").focus();\n      } catch(err) {\n        document.getElementById(\"results\").innerHTML += err.message.replace(/</g,'&lt;').replace(/>/g,'&gt;') + \"\\r\";\n      }\n    } else {\n      document.getElementById(\"results\").innerHTML +=\n  `The Web serial API needs to be enabled in your browser thru:\n      - <a href=edge://flags/#enable-experimental-web-platform-features>edge://flags/#enable-experimental-web-platform-features</a>\n      - <a href=chrome://flags/#enable-experimental-web-platform-features>chrome://flags/#enable-experimental-web-platform-features</a>\n      - <a href=opera://flags/#enable-experimental-web-platform-features>opera://flags/#enable-experimental-web-platform-features</a>\n  `;\n    }\n  }\n\n  // receive a string from the device\n  receive = async () =>\n  {\n    var result = await this.reader.read();\n    // var str = this.dec.decode(result.value);\n    var str = result.value;\n    // console.log(\"receive\", str.length, str)\n\n    // document.getElementById(\"results\").innerHTML += str.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\\n/g,'');\n    // document.getElementById(\"command\").scrollIntoView();\n\n    this.app.update(str)\n\n    if (this.running)\n      setTimeout(this.receive, 10);\n  }\n\n  // send a string to the device\n  send = async (str) =>\n  {\n    console.log(\"send\", str.length, str)\n    str = str.substr(0,1)\n\n    await this.writer.write(this.enc.encode(str).buffer);\n\n    // document.getElementById(\"command\").value = \"\";\n    // document.getElementById(\"command\").focus();\n\n    this.receive();\n\n  }\n\n  start = async () =>\n  {\n    // var str = document.getElementById(\"command\").value;\n    var str = \"1\";\n    this.send(str + \"\\r\");\n    this.running = true;\n  }\n\n  stop = async () =>\n  {\n    this.running = false;\n  }\n\n}\n\nexport default Serial\n\n","export default __webpack_public_path__ + \"static/media/fi_box.7788464f.svg\";","export default __webpack_public_path__ + \"static/media/heading_yaw.19291b56.svg\";","export default __webpack_public_path__ + \"static/media/heading_mechanics.c70ba00f.svg\";","export default __webpack_public_path__ + \"static/media/fi_circle.0f3ed5da.svg\";","export default __webpack_public_path__ + \"static/media/horizon_back.2cd546c3.svg\";","export default __webpack_public_path__ + \"static/media/vertical_mechanics.b6d15087.svg\";","export default __webpack_public_path__ + \"static/media/fi_needle.8540336b.svg\";","export default __webpack_public_path__ + \"static/media/turn_coordinator.20e29bc7.svg\";","export default __webpack_public_path__ + \"static/media/fi_tc_airplane.c8621577.svg\";","export default __webpack_public_path__ + \"static/media/speed_mechanics.88e98fdb.svg\";","export default __webpack_public_path__ + \"static/media/altitude_pressure.8a2c5bba.svg\";","export default __webpack_public_path__ + \"static/media/altitude_ticks.5db31bf9.svg\";","export default __webpack_public_path__ + \"static/media/fi_needle_small.ec4e2e85.svg\";","export default __webpack_public_path__ + \"static/media/horizon_ball.bcc94b5c.svg\";","export default __webpack_public_path__ + \"static/media/horizon_circle.d636f515.svg\";","export default __webpack_public_path__ + \"static/media/horizon_mechanics.7a08d837.svg\";","import React from 'react'\n\nimport fi_box from './img/fi_box.svg'\nimport heading_yaw from './img/heading_yaw.svg'\nimport heading_mechanics from './img/heading_mechanics.svg'\nimport fi_circle from './img/fi_circle.svg'\nimport vertical_mechanics from './img/vertical_mechanics.svg'\nimport fi_needle from './img/fi_needle.svg'\nimport turn_coordinator from './img/turn_coordinator.svg'\nimport fi_tc_airplane from './img/fi_tc_airplane.svg'\nimport speed_mechanics from './img/speed_mechanics.svg'\nimport altitude_pressure from './img/altitude_pressure.svg'\nimport altitude_ticks from './img/altitude_ticks.svg'\nimport fi_needle_small from './img/fi_needle_small.svg'\nimport horizon_back from './img/horizon_back.svg'\nimport horizon_ball from './img/horizon_ball.svg'\nimport horizon_circle from './img/horizon_circle.svg'\nimport horizon_mechanics from './img/horizon_mechanics.svg'\n\nconst constants = {\n  pitch_bound: 30,\n  vario_bound: 1.95,\n  airspeed_bound_l: 0,\n  airspeed_bound_h: 160\n}\n\nconst box = {\n  width: '100%',\n  height: '100%',\n  position: 'absolute',\n  top: 0,\n  left: 0\n}\n\nconst Instrument = ({ children, showBox, size }) => {\n  return (\n    <div className=\"instrument heading\" style={{ \n      height: size ?? '250px',\n      width: size ?? '250px',\n      position: 'relative',\n      display: 'inline-block',\n      overflow: 'hidden'\n    }}>\n      {(showBox ?? true) &&\n        <img src={fi_box} className=\"background box\" style={box} alt=\"\" />\n      }\n      {children}\n    </div>\n  )\n}\n\nexport const HeadingIndicator = (params) => {\n  return (\n    <Instrument {...params}>\n      <div className=\"heading box\" style={{ ...box, transform: `rotate(${-params.heading ?? 0}deg)` }}>\n        <img src={heading_yaw} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"mechanics box\" style={box}>\n        <img src={heading_mechanics} className=\"box\" style={box} alt=\"\" />\n        <img src={fi_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n    </Instrument>\n  )\n}\n\nexport const Variometer = (params) => {\n  let vario = (params.vario ?? 0) / 1000\n\n  if (vario > constants.vario_bound) vario = constants.vario_bound\n  else if (vario < -constants.vario_bound) vario = -constants.vario_bound\n\n  vario = vario * 90;\n\n  return (\n    <Instrument {...params}>\n      <img src={vertical_mechanics} className=\"box\" style={box} alt=\"\" />\n      <div className=\"vario box\" style={{ ...box, transform: `rotate(${vario}deg)` }}>\n        <img src={fi_needle} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"mechanics box\" style={box}>\n        <img src={fi_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n    </Instrument>\n  )\n}\n\nexport const TurnCoordinator = (params) => {\n  return (\n    <Instrument {...params}>\n      <img src={turn_coordinator} className=\"box\" style={box} alt=\"\" />\n      <div className=\"turn box\" style={{ ...box, transform: `rotate(${params.turn}deg)` }}>\n        <img src={fi_tc_airplane} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"mechanics box\" style={box}>\n        <img src={fi_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n    </Instrument>\n  )\n}\n\nexport const Airspeed = (params) => {\n  let speed = params.speed ?? 0\n\n  if (speed > constants.airspeed_bound_h) speed = constants.airspeed_bound_h\n  else if (speed < constants.airspeed_bound_l) speed = constants.airspeed_bound_l\n\n  speed = 90 + speed * 2\n\n  return (\n    <Instrument {...params}>\n      <img src={speed_mechanics} className=\"box\" style={box} alt=\"\" />\n      <div className=\"speed box\" style={{ ...box, transform: `rotate(${speed}deg)` }}>\n        <img src={fi_needle} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"mechanics box\" style={box}>\n        <img src={fi_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n    </Instrument>\n  )\n}\n\nexport const Altimeter = (params) => {\n  let altitude = params.altitude ?? 0\n  let needle = 90 + altitude % 1000 * 360 / 1000\n  let needleSmall = altitude / 10000 * 360\n\n  let pressure = params.pressure ?? 1013.25\n  pressure = 2 * pressure - 1980\n\n  return (\n    <Instrument {...params}>\n      <div className=\"pressure box\" style={{ ...box, transform: `rotate(${pressure}deg)` }}>\n        <img src={altitude_pressure} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <img src={altitude_ticks} className=\"box\" style={box} alt=\"\" />\n      <div className=\"needleSmall box\" style={{ ...box, transform: `rotate(${needleSmall}deg)` }}>\n        <img src={fi_needle_small} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"needle box\" style={{ ...box, transform: `rotate(${needle}deg)` }}>\n        <img src={fi_needle} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"mechanics box\" style={box}>\n        <img src={fi_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n    </Instrument>\n  )\n}\n\nexport const AttitudeIndicator = (params) => {\n  let pitch = params.pitch ?? 0\n  if (pitch > constants.pitch_bound) { pitch = constants.pitch_bound; }\n  else if (pitch < -constants.pitch_bound) { pitch = -constants.pitch_bound; }\n\n  return (\n    <Instrument {...params}>\n      <div className=\"roll box\" style={{ ...box, top: '0%', transform: `rotate(${params.roll ?? 0}deg)` }}>\n        <img src={horizon_back} className=\"box\" alt=\"\" style={{ ...box }} />\n        <div className=\"pitch box\" style={{ ...box, top: `${(pitch) * 0.7}%` }}>\n          <img src={horizon_ball} className=\"box\" style={box} alt=\"\" />\n        </div>\n        <img src={horizon_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n      <div className=\"mechanics box\" style={box}>\n        <img src={horizon_mechanics} className=\"box\" style={box} alt=\"\" />\n        <img src={fi_circle} className=\"box\" style={box} alt=\"\" />\n      </div>\n    </Instrument>\n  )\n}\n","import \"./styles.css\";\nimport { Canvas } from \"@react-three/fiber\";\nimport { useLoader } from \"@react-three/fiber\";\nimport { OBJLoader } from \"three/examples/jsm/loaders/OBJLoader\";\nimport { MTLLoader } from \"three/examples/jsm/loaders/MTLLoader\";\nimport React, { Suspense } from \"react\";\nimport Serial from \"./Serial\";\nimport { AttitudeIndicator, HeadingIndicator } from './react-flight-indicators'\n\n// THREE.DefaultLoadingManager.addHandler(/\\.dds$/i, new DDSLoader());\n\nconst Scene = (props) => {\n  const materials = useLoader(MTLLoader, \"11805_airplane_v2_L2.mtl\");\n  const obj = useLoader(OBJLoader, \"11805_airplane_v2_L2.obj\", (loader) => {\n    materials.preload();\n    loader.setMaterials(materials);\n  });\n\n  // console.log('---', props.rotate.rx);\n  return  (<primitive\n              object={obj}\n              rotation-x={  props.rotate.ry + Math.PI / (-2)}\n              rotation-y={ -props.rotate.rx}\n              rotation-z={  props.rotate.rz}\n              scale={0.003}\n            />\n          );\n};\n\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {rx: 0, ry: 0, rz: 0};\n    this.serial = new Serial();\n    this.serial.setApp(this);\n    this.buffer = \"\";\n  }\n\n  componentDidMount() {\n    // setInterval(this.test_update, 10);\n  }\n\n  update = (str) => {\n    var rotate = str.split(\",\").map(s => Number(s))\n    switch (rotate.length) {\n      case 3 :\n        console.log(\"three\", rotate)\n        this.setState({\n          ...this.state,\n          rx : rotate[0],\n          ry : rotate[1],\n          rz : rotate[2]\n        })\n        break;\n      default:\n        break;\n    }\n  };\n\n  test_update = () => {\n    this.setState({\n      ...this.state,\n      rx : this.state.rx - 0.001,\n      ry : this.state.ry + 0.001,\n      rz : this.state.rz + 0.001,\n    })\n  };\n\n  render() {\n    return (\n      <div className=\"App\">\n        <div>\n          <h1>Gyro Viewer</h1>\n          Select:\n          <button\n            type='button'\n            onClick={(event) => {\n              this.serial.connect();\n            }}\n          >\n            COM\n          </button>\n          &nbsp;&nbsp;Command:\n          <button type='button'\n            onClick={(event) => {\n              this.serial.start();\n            }}\n          >\n            Start\n          </button>\n          &nbsp;\n          <button type='button'\n            onClick={(event) => {\n              this.serial.stop();\n            }}\n          >\n            Stop\n          </button>\n          <pre id='results'> Messages </pre>\n        </div>\n\n        <div>\n          <HeadingIndicator  size={150} heading={-this.state.rz * 180/Math.PI} showBox={false} />\n          <AttitudeIndicator size={150}  width={100} roll={-this.state.rx * 180/Math.PI} pitch={this.state.ry * 180/Math.PI} showBox={false} />\n          {/* <HeadingIndicator  size={150} heading={Math.random() * 360} showBox={false} />\n          <AttitudeIndicator size={150}  width={100} roll={(Math.random() - 0.5) * 120} pitch={(Math.random() - 0.5) * 40} showBox={false} /> */}\n        </div>\n\n        <Canvas>\n          <pointLight position={[0, 5, 30]} />\n          <Suspense fallback={null}>\n            <Scene rotate={this.state} />\n          </Suspense>\n        </Canvas>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(<App />, rootElement);\n"],"sourceRoot":""}